
<html>
  <head lang="zh">
        <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
        <meta content="yes" name="apple-mobile-web-app-capable"/>
        <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
        <meta content="telephone=no" name="format-detection"/>
        <meta name="renderer" content="webkit">
    <title>Redis基础 | Iktsuarpok</title>
<link href="https://liuyuzheng8.github.io/styles/main.css" type="text/css" rel="stylesheet"/>
<script type="text/javascript" src="https://liuyuzheng8.github.io/media/scripts/jquery.js"></script>
<script type="text/javascript" src="https://liuyuzheng8.github.io/media/scripts/basic.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  </head>

  <body>
     <div class="header">
      <div class="logo_title">
		  
        <div class="title animated fadeInDown"><img src="https://liuyuzheng8.github.io/images/avatar.png?v=1583500720529"/>

          <h1 title="Iktsuarpok" class="weaklink"><a href="/">Iktsuarpok</a>

          </h1>

          <div class="navbar weaklink">
            <div class="normal_nav">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
		
      <ul class="mixed_site_nav site_nav sm sm-base">
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io" class="selected active current nav__item" >首页</a>

  </li>
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io/tags" class="selected active current nav__item" >标签</a>

  </li>
 
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io/archives" class="selected active current nav__item" >归档</a>

  </li>
 

      </ul>

      <div class="clear clear_nav_inline_end"></div>

    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

            </div>

            <div class="hamberger"><i class="fa fa-bars"></i>
<i class="fa fa-times"></i>

            </div>

          </div>

        </div>

      </div>

      <div class="hidden_nav animated fadeInDown">

<div class="bitcron_nav_container">


  <div class="bitcron_nav">
    <div class="mixed_site_nav_wrap site_nav_wrap">
      <ul class="mixed_site_nav site_nav sm sm-base">
		  
	
  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io" class="selected active current nav__item" >首页</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io/tags" class="selected active current nav__item" >标签</a>

  </li>


  <li><a id="d2ef19af68cc211e98f8a0242ac110003" href="https://liuyuzheng8.github.io/archives" class="selected active current nav__item" >归档</a>

  </li>





      </ul>

      <div class="clear clear_nav_inline_end"></div>

    </div>

  </div>



  <div class="clear clear_nav_end"></div>

</div>

      </div>

    </div>


    <div class="main">
      <div class="main-inner">


<div class="content">






  <div class="post_page" >

<div class="post">
  <div class="post_title sm_margin">
    <h2><a>Redis基础</a>



    </h2>
  </div>

  <div class="post_details">
    <div class="info"><i class="fa fa-clock-o"></i>
<span class="date_info">2020-03-06</span>
<i class="fa fa-eye"></i>

<span class="date_info"><span id="busuanzi_value_page_pv"></span> Views</span>


<i class="fa fa-bookmark-o"></i>
<span class="tags_info weaklink">
	
	<a href="https://liuyuzheng8.github.io/tag/i5L1NzG9C/" class="tag">数据库</a>

	<a href="https://liuyuzheng8.github.io/tag/Pwkspp1Yt/" class="tag">Redis</a>


</span>


    </div>

  </div>





  <div class="post_content markdown"><p class="md_block">
    <span class="md_line md_line_start md_line_end"><h1 id="redis基础">Redis基础</h1>
<h2 id="redis简介">Redis简介</h2>
<h3 id="nosql">NoSQL</h3>
<p>NoSQL：即Not-OnlySQL（泛指非关系型的数据库），作为关系型数据库的补充。</p>
<p>作用：应对基于海量用户和海量数据前提下的数据处理问题。</p>
<p>特征：</p>
<ul>
<li>可扩容，可伸缩</li>
<li>大数据量下高性能</li>
<li>灵活的数据模型</li>
<li>高可用</li>
</ul>
<hr>
<h3 id="redis概念">Redis概念</h3>
<p><strong>Redis</strong>是用C语言开发的一个开源的高性能键值对（key-value）数据库。</p>
<p>特征：</p>
<ol>
<li>数据间没有必然的关联关系</li>
<li>内部采用<strong>单线程</strong>机制进行工作</li>
<li>高性能</li>
<li>多数据类型支持</li>
<li>持久化支持</li>
</ol>
<hr>
<h2 id="redis数据">Redis数据</h2>
<h3 id="redis数据存储格式">Redis数据存储格式</h3>
<p>Redis自身的是一个Map，所有的数据以键值对的方式存储。</p>
<blockquote>
<p>key的设置约定</p>
</blockquote>
<p>表名：主键名：主键值：字段名</p>
<hr>
<h3 id="数据类型">数据类型</h3>
<blockquote>
<p>string类型</p>
</blockquote>
<ul>
<li>存储的数据：单个数据，最简单的数据存储类型，也是最常用的数据存储类型</li>
<li>存储数据的格式：一个存储空间保存一个数据</li>
<li>存储内容：通常使用字符串，如果字符串以整数的形式是展示，可以作为数字操作使用</li>
</ul>
<blockquote>
<p>hash类型</p>
</blockquote>
<ul>
<li>存储需求：对一系列存储的数据进行编组，方便管理，典型应用存储对象信息</li>
<li>需要的存储结构：一个存储空间保存多个键值对数据</li>
<li>hash：底层使用哈希表结构实现数据存储</li>
</ul>
<blockquote>
<p>list类型</p>
</blockquote>
<ul>
<li>存储需求：存储多个数据，并对数据进入存储空间的顺序进行区分</li>
<li>需要的存储结构：一个存储空间保存多个数据，且通过数据可以体现进入顺序</li>
<li>list：保存多个数据，底层使用双向链表存储结构实现</li>
</ul>
<blockquote>
<p>set类型</p>
</blockquote>
<ul>
<li>存储需求：存储大量的数据，在查询方面提供跟高的效率</li>
<li>需要的存储结构：能够保存大量的数据，高效的内部存储机制，便于查询</li>
<li>set：与hash的存储结构完全相同，将值存储于hash的key中，hash的value中存储nil，并且值不允许重复</li>
</ul>
<blockquote>
<p>sorted_set类型</p>
</blockquote>
<ul>
<li>存储需求：数据排序有利于数据的有效展示，需要提供一种可以根据自身特征进行排序的方式</li>
<li>需要的存储结构：新的存储模型，可以保存可排序的数据</li>
<li>sorted_set：在set的存储结构基础上添加可排序字段</li>
</ul>
<hr>
<h2 id="redis的基本操作">Redis的基本操作</h2>
<h3 id="string类型">String类型</h3>
<blockquote>
<p>信息添加</p>
</blockquote>
<ul>
<li>
<p>功能：设置 key value</p>
</li>
<li>
<p>命令</p>
</li>
</ul>
<pre><code>set key value
</code></pre>
<blockquote>
<p>信息查询</p>
</blockquote>
<ul>
<li>
<p>功能：根据 key 查询 value</p>
</li>
<li>
<p>命令</p>
</li>
</ul>
<pre><code>get key
</code></pre>
<blockquote>
<p>信息删除</p>
</blockquote>
<ul>
<li>
<p>功能：删除 key value</p>
</li>
<li>
<p>命令</p>
</li>
</ul>
<pre><code>del key
</code></pre>
<blockquote>
<p>添加/修改多个数据</p>
</blockquote>
<pre><code>mset key1 value1 key2 value2 ...
</code></pre>
<blockquote>
<p>获取多个数据</p>
</blockquote>
<pre><code>mget key1 key2 ...
</code></pre>
<blockquote>
<p>获取数据字符个数（字符串长度）</p>
</blockquote>
<pre><code>strlen key
</code></pre>
<blockquote>
<p>追加信息到原始信息后</p>
</blockquote>
<pre><code>append key value
</code></pre>
<blockquote>
<p>设置数值数据增加/减少指定范围的值</p>
</blockquote>
<pre><code>incr/decr key
incrby/decrby key integerNumber
incrbyfloat key floatNumber
</code></pre>
<blockquote>
<p>设置指定时常的生命周期的数据</p>
</blockquote>
<pre><code>setex key seconds value		
psetex key milliseconds		
</code></pre>
<p><strong>注意事项：</strong></p>
<ul>
<li>数据操作返回值
<ul>
<li>表示数据运行结果是否成功，成功：(integer)1、失败：(integer)0</li>
<li>表示运行结果值，如：(integer)3</li>
</ul>
</li>
<li>未获取到数据
<ul>
<li>(nil) 等同于null</li>
</ul>
</li>
<li>数据最大存储量：512MB</li>
</ul>
<hr>
<h3 id="hash类型">Hash类型</h3>
<blockquote>
<p>添加/修改数据</p>
</blockquote>
<pre><code>hset key field value
hsetnx key field value 		//如果库中存在key则不添加
</code></pre>
<blockquote>
<p>获取数据</p>
</blockquote>
<pre><code>hget key field
hgetall key			//获取全部
</code></pre>
<blockquote>
<p>删除数据</p>
</blockquote>
<pre><code>hdel key field1 [field2]
</code></pre>
<blockquote>
<p>添加/修改多个数据</p>
</blockquote>
<pre><code>hmset key field1 value1 field2 value2 ...
</code></pre>
<blockquote>
<p>获取数据</p>
</blockquote>
<pre><code>hmget key field1 field2 ...
</code></pre>
<blockquote>
<p>获取哈希表中的字数</p>
</blockquote>
<pre><code>hlen key
</code></pre>
<blockquote>
<p>获取哈希表中是否存在指定字段</p>
</blockquote>
<pre><code>hexists key field
</code></pre>
<blockquote>
<p>获取哈希表中所有的字段名或字段值</p>
</blockquote>
<pre><code>hkeys key
hvals key

</code></pre>
<blockquote>
<p>设置指定字段的数值数据增加指定范围的值</p>
</blockquote>
<pre><code>hincrby key field integerNumber
hincrbyfloat key field floatNumber

</code></pre>
<p><strong>注意事项：</strong></p>
<ul>
<li>hash类型下的value只能存储字符串，不允许存储其他数据类型</li>
<li>每个hash可以存储2<sup>32</sup>-1个键值对</li>
<li>hash类型十分贴近对象的数据存储形式，并且可以灵活的添加或删除对象属性，但hash设计初衷并不是为了存储大量对象，所以不可滥用，更不可将hash作为对象列表使用</li>
<li>hgetall可以获取全部属性，但是如果内部field过多，会导致遍历整体数据效率变低，成为数据访问瓶颈</li>
</ul>
<hr>
<h3 id="list类型">List类型</h3>
<blockquote>
<p>添加/修改数据</p>
</blockquote>
<pre><code>lpush key value1 [value2] ...	//左进入
rpush key value1 [value2] ...	//右进入

</code></pre>
<blockquote>
<p>获取数据</p>
</blockquote>
<pre><code>lrange key start stop
lindex key index
llen key

</code></pre>
<blockquote>
<p>获取并移除数据</p>
</blockquote>
<pre><code>lpop key
rpop key

</code></pre>
<blockquote>
<p>规定时间内获取并移除数据</p>
</blockquote>
<pre><code>blpop key1 [key2] timeout
brpop key1 [key2] timeout

</code></pre>
<blockquote>
<p>移除指定数据</p>
</blockquote>
<pre><code>lrem key count value

</code></pre>
<p><strong>注意事项：</strong></p>
<ul>
<li>list中保存的数据都是string类型的，最多容纳2<sup>32</sup>-1条数据</li>
<li>list具有索引的概念，但是操作时通常以队列的形式进行出入队操作，或以栈形式进行出入栈操作</li>
<li>获取全部数据操作的结束索引设置为-1</li>
<li>list可以对数据进行分页操作，通常第一页信息来自于list，第二页及更多信息通过数据库加载</li>
</ul>
<hr>
<h3 id="set类型">Set类型</h3>
<blockquote>
<p>添加数据</p>
</blockquote>
<pre><code>sadd key member1 [member2]

</code></pre>
<blockquote>
<p>获取全部数据</p>
</blockquote>
<pre><code>semebers key

</code></pre>
<blockquote>
<p>删除数据</p>
</blockquote>
<pre><code>srem key member1 [member2]

</code></pre>
<blockquote>
<p>获取集合数据总量</p>
</blockquote>
<pre><code>scard key

</code></pre>
<blockquote>
<p>判断集合中是否包含指定数据</p>
</blockquote>
<pre><code>sismember key member

</code></pre>
<blockquote>
<p>随机获取集合中指定数量的数据</p>
</blockquote>
<pre><code>srandmember key [count]

</code></pre>
<blockquote>
<p>随机获取集合中的某个数据并将该数据移出集合</p>
</blockquote>
<pre><code>spop key [count]

</code></pre>
<blockquote>
<p>求两个集合的交、并、差集</p>
</blockquote>
<pre><code>sinter key1 [key...]
sunion key1 [key...]
sdiff key1 [key...]

</code></pre>
<blockquote>
<p>求两个集合的交、并、差集并存到指定集合中</p>
</blockquote>
<pre><code>sinterstore destination key1 [key...]
sunionstore destination key1 [key...]
sdiffstore destination key1 [key...]

</code></pre>
<blockquote>
<p>将指定数据从原始集合中移动到目标集合中</p>
</blockquote>
<pre><code>smove source destination member

</code></pre>
<p><strong>注意事项：</strong></p>
<ul>
<li>set类型不允许数据重复，如果添加的数据在set中已存在，将只保留一份</li>
<li>set虽然与hash的存储结构相同，但是无法启用hash中存储值的空间</li>
</ul>
<hr>
<h3 id="sorted_set类型">Sorted_set类型</h3>
<blockquote>
<p>添加数据</p>
</blockquote>
<pre><code>zadd key score1 member1 [score member ...]

</code></pre>
<blockquote>
<p>获取全部数据</p>
</blockquote>
<pre><code>zrange key start stop [WITHSCORES]
zrevrange key start stop [WITHSCORES]

</code></pre>
<blockquote>
<p>删除数据</p>
</blockquote>
<pre><code>zrem key member [member ...]

</code></pre>
<blockquote>
<p>按条件获取数据</p>
</blockquote>
<pre><code>zrangebyrescore key min max [WITHSCORES] [LIMIT]
zrevrangebyscore key min max [WITHSCORES] [LIMIT]

</code></pre>
<blockquote>
<p>条件删除数据</p>
</blockquote>
<pre><code>zremrangebyrank key start stop
zremrangebyscore key min max

</code></pre>
<blockquote>
<p>获取集合数据总量</p>
</blockquote>
<pre><code>zcard key
zcount key min max

</code></pre>
<blockquote>
<p>集合交、并操作</p>
</blockquote>
<pre><code>zinterstore destination numkeys key [key ...]
zunionstore destination numkeys key [key ...]

</code></pre>
<blockquote>
<p>获取数据对应的索引（排名）</p>
</blockquote>
<pre><code>zrank key member
zrevrank key member

</code></pre>
<blockquote>
<p>score值获取与修改</p>
</blockquote>
<pre><code>zscore key member
zincrby key increment 

</code></pre>
<p><strong>注意事项：</strong></p>
<ul>
<li>score保存的数据存储空间是64位</li>
<li>score保存的数据也可以是一个双精度的double值，基于双精度浮点数的特征，可能会丢失精度，使用时需要谨慎</li>
<li>sorted_set底层存储结构还是基于set的，因此数据不允许重复，如果重复添加数据，score值将被覆盖，保留最后一次修改的结果</li>
</ul>
<hr>
<h2 id="通用命令">通用命令</h2>
<h3 id="key的基本操作">key的基本操作</h3>
<blockquote>
<p>删除指定key</p>
</blockquote>
<pre><code>del key

</code></pre>
<blockquote>
<p>获取key是否存在</p>
</blockquote>
<pre><code>exists key

</code></pre>
<blockquote>
<p>获取key的类型</p>
</blockquote>
<pre><code>type key

</code></pre>
<blockquote>
<p>查询key</p>
</blockquote>
<pre><code>keys pattern
* 匹配任意数量的任意符号
? 匹配任意一个符号
[] 匹配一个指定的符号

</code></pre>
<blockquote>
<p>改变key的名字</p>
</blockquote>
<pre><code>rename key newkey
renamenx key newkey

</code></pre>
<blockquote>
<p>对所有key排序</p>
</blockquote>
<pre><code>sort

</code></pre>
<p><strong>时效性操作：</strong></p>
<blockquote>
<p>为指定的key设置有效期</p>
</blockquote>
<pre><code>expire key seconds
pexpire key milliseconds
expireat key timestamp
pexpireat key milliseconds

</code></pre>
<blockquote>
<p>获取key的有效时间</p>
</blockquote>
<pre><code>ttl key
pttl key

</code></pre>
<blockquote>
<p>将key从时效性转换为永久性</p>
</blockquote>
<pre><code>persist key

</code></pre>
<hr>
<h3 id="数据库基本操作">数据库基本操作</h3>
<ul>
<li>redis为每个服务提供有16个数据库，编号从0-15</li>
<li>每个数据库之间的数据相互独立</li>
</ul>
<blockquote>
<p>切换数据库</p>
</blockquote>
<pre><code>select index

</code></pre>
<blockquote>
<p>数据移动</p>
</blockquote>
<pre><code>move key db

</code></pre>
<blockquote>
<p>数据清除</p>
</blockquote>
<pre><code>dbsize		//查看数据总量
flushdb		//清除当前数据
flushall	//清除全部数据

</code></pre>
<blockquote>
<p>其他操作</p>
</blockquote>
<pre><code>quit
ping
echo message

</code></pre>
<hr>
<h2 id="jdies">Jdies</h2>
<blockquote>
<p>Jedis简介</p>
</blockquote>
<p>Jedis是Java语言连接redis服务。</p>
<hr>
<h3 id="使用方式">使用方式</h3>
<blockquote>
<p>在pom文件中导入jedis的依赖。</p>
</blockquote>
<pre><code class="language-xml">        &lt;!-- jedis --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;redis.clients&lt;/groupId&gt;
            &lt;artifactId&gt;jedis&lt;/artifactId&gt;
            &lt;version&gt;3.2.0&lt;/version&gt;
        &lt;/dependency&gt;

</code></pre>
<blockquote>
<p>在类中进行连接</p>
</blockquote>
<pre><code class="language-java">        //1.连接redis
        Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379);
        //2.操作redis
        jedis.set(&quot;name&quot;,&quot;squid&quot;);//Jedis中的方法名与redis中命令名完全一致
        String name = jedis.get(&quot;name&quot;);
        System.out.println(name);
        //3.断开连接
        jedis.close();

</code></pre>
<p>**注意：**从redis中取出的所有数据类型与java中的数据类型一一对应。</p>
<hr>
<h3 id="jedis工具类">Jedis工具类</h3>
<pre><code class="language-java">public class JedisUtil {
    private static JedisPool jedisPool = null;
    private static Integer port = null;
    private static Integer maxTotal = null;
    private static Integer maxIdle = null;

    static{
        ResourceBundle resourceBundle = ResourceBundle.getBundle(&quot;redis&quot;);//获取配置文件
        String host = resourceBundle.getString(&quot;redis.host&quot;);
        port = Integer.valueOf(resourceBundle.getString(&quot;redis.port&quot;));
        maxTotal = Integer.valueOf(resourceBundle.getString(&quot;redis.maxTotal&quot;));
        maxIdle = Integer.valueOf(resourceBundle.getString(&quot;redis.maxIdle&quot;));

        JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        jedisPoolConfig.setMaxTotal(maxTotal);//最大连接数
        jedisPoolConfig.setMaxIdle(maxIdle);//活动连接数
        jedisPool = new JedisPool(jedisPoolConfig,host,port);
    }
    public static Jedis getJedis(){
        return jedisPool.getResource();
    }
}

</code></pre>
</p>

     <p class="md_block">
    <div class="reward"><div class="reward-button">赏 <span class="reward-code"> <span class="alipay-code"> <img class="alipay-img" src="https://liuyuzheng8.github.io/media/images/alipay.png"><b>支付宝扫码打赏</b> </span> <span class="wechat-code"> <img class="wechat-img" src="https://liuyuzheng8.github.io/media/images/wechat.png"><b>微信打赏</b> </span> </span></div></div>
</p> 
</div>

</div>



<link href="https://liuyuzheng8.github.io/styles/main.css" type="text/css" rel="stylesheet"/>

<div class="doc_comments">

</div>



  </div>
</div>



      </div>




    </div>

   <div class="footer">
<link href="https://liuyuzheng8.github.io/styles/main.css" type="text/css" rel="stylesheet"/><div class="site_footer_wrap"><div class="site_footer">

      <div class="mysocials"><div class="my_socials">
		   
			   
    
			   
    
			   
    
			   
    
</div><link href="https://liuyuzheng8.github.io/styles/main.css" type="text/css" rel="stylesheet"/>

      </div>

      <div class="copyright">Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
      </div>

</div></div>

    </div>


<style type="text/css">a.back_to_top {
    text-decoration: none;
    position: fixed;
    bottom: 40px;
    right: 30px;
    background: #f0f0f0;
    height: 40px;
    width: 40px;
    border-radius: 50%;
    line-height: 36px;
    font-size: 18px;
    text-align: center;
    transition-duration: .5s;
    transition-propety: background-color;
    display: none;
}

a.back_to_top span {
    color: #888;
}

a.back_to_top:hover {
    cursor: pointer;
    background: #dfdfdf;
}

a.back_to_top:hover span {
    color: #555;
}

@media print, screen and (max-width: 580px) {
    .back_to_top {
        display: none !important;
    }
}



</style><a id="back_to_top" href="#" class="back_to_top"><span>△</span>
</a>
<script type="text/javascript" src="https://liuyuzheng8.github.io/media/scripts/jquery.js"></script>

<script>$(document).ready((function(_this) {
  return function() {
    var bt;
    bt = $('#back_to_top');
    if ($(document).width() > 480) {
      $(window).scroll(function() {
        var st;
        st = $(window).scrollTop();
        if (st > 30) {
          return bt.css('display', 'block');
        } else {
          return bt.css('display', 'none');
        }
      });
      return bt.click(function() {
        $('body,html').animate({
          scrollTop: 0
        }, 800);
        return false;
      });
    }
  };
})(this));
</script>

</body>

</html>